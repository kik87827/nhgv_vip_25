<div class="survey_document_wrap">
    <div class="survey_swiper_zone">
        <div class="swiper-container survey">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="survey_gate_wrap">
                        <div class="survey_gate_top">
                            <div class="survey_gate_title_wrap">
                                <p class="survey_gate_title_main">NH투자증권</p>
                                <p class="survey_gate_title_sub">Premier Blue Members</p>
                            </div>
                            <p class="survey_gate_docu_title">만족도조사</p>
                        </div>
                        <div class="survey_gate_bottom">
                            <span class="survey_bottom_logo"><img src="./assets/images/survey/survey_logo.png" alt=""></span>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="survey_docu_wrap">
                        <div class="survey_title_row">
                            <p class="survey_title_main"><span class="survey_title_bullet">01</span><span class="survey_title_liquid">수령 확인</span></p>
                            <p class="survey_title_sub">
                                <strong>NH투자증권 Premier Blue Members</strong>
                                기프트(바우처)는 이상 없이 잘 받으셨는지요?
                            </p>
                        </div>
                        <div class="survey_form_row">
                            <ul class="survey_form_list">
                                <li><button class="props_button">1. 네</button></li>
                                <li><button class="props_button">2. 아니요</button></li>
                                <li class="has_ta"><textarea rows="10" cols="10" class="survey_ta" placeholder="의견 :"></textarea></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="survey_docu_wrap">
                        <div class="survey_title_row">
                            <p class="survey_title_main"><span class="survey_title_bullet">02</span><span class="survey_title_liquid">기프트 만족도</span></p>
                            <p class="survey_title_sub">
                                고객님께서 받으신 <br>
                                기프트(바우처)는 어떠셨는지요? 
                            </p>
                        </div>
                        <div class="survey_form_row">
                            <ul class="survey_form_list">
                                <li><button class="props_button">1. 만족</button></li>
                                <li><button class="props_button">2. 보통</button></li>
                                <li><button class="props_button">3. 불만족</button></li>
                                <li class="has_ta"><textarea rows="10" cols="10" class="survey_ta" placeholder="의견 :"></textarea></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="survey_docu_wrap">
                        <div class="survey_title_row">
                            <p class="survey_title_main"><span class="survey_title_bullet">03</span><span class="survey_title_liquid">기프트 선호도</span></p>
                            <p class="survey_title_sub">
                                향후 희망하거나 새롭게 추가되었으면 하는 카테고리를 선택해주세요. (중복선택 가능)
                            </p>
                        </div>
                        <div class="survey_form_row">
                            <ul class="survey_form_list">
                                <li>
                                    <ul class="props_item_list">
                                        <li><button class="props_button">다이닝</button></li>
                                        <li><button class="props_button">호텔</button></li>
                                        <li><button class="props_button">한우</button></li>
                                        <li><button class="props_button">뷰티</button></li>
                                        <li><button class="props_button">골프</button></li>
                                        <li><button class="props_button">건강검진</button></li>
                                        <li><button class="props_button">와인</button></li>
                                        <li><button class="props_button">가전</button></li>
                                        <li><button class="props_button">식품</button></li>
                                        <li><button class="props_button">클래스</button></li>
                                        <li><button class="props_button">캠핑</button></li>
                                        <li><button class="props_button">리빙</button></li>
                                        <li><button class="props_button">레저</button></li>
                                        <li><button class="props_button">기타</button></li>
                                    </ul>
                                </li>
                                <li class="has_ta"><textarea rows="10" cols="10" class="survey_ta" placeholder="의견 :"></textarea></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="survey_docu_wrap">
                        <div class="survey_title_row">
                            <p class="survey_title_main"><span class="survey_title_bullet">04</span><span class="survey_title_liquid">향후 받고싶은 기프트가 있으면 말씀해 주세요.</span></p>
                        </div>
                        <div class="survey_form_row">
                            <ul class="survey_form_list">
                                <li class="has_ta"><textarea rows="10" cols="10" class="survey_ta" placeholder="의견 :"></textarea></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="survey_docu_wrap type2">
                        <div class="survey_docu_inner">
                            <p class="survey_docu_message">소중한 의견<br>감사합니다.</p>
                        </div>
                        <div class="survey_docu_btn_row">
                            <a href="javascript:void(0)" class="btn_control_box close_trigger">확인</a>
                        </div>
                        <!-- <button class="btn_survey_close"></button> -->
                    </div>
                </div>
            </div>
        </div>
        <div class="swiper_pagination_layer">
            <div class="swiper_pagination_cols">
                <div class="swiper-pagination">

                </div>
            </div>
            <div class="swiper_fraction_cols">
                <span class="swiper_fraction_para">
                    <span class="swiper_fraction_current">1</span>
                    <span class="swiper_fraction_part">/</span>
                    <span class="swiper_fraction_length">4</span>
                </span>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded",()=>{
        surveyLayerFunc();
    });


    
    function surveyLayerFunc(){
        const htmlElement = document.documentElement;
        const bodyElement = document.body;
        const survey_document_wrap = document.querySelector(".survey_document_wrap");
        const survey_swiper_container = document.querySelector(".swiper-container.survey");
        const survey_swiper_slide = survey_swiper_container.querySelectorAll(".swiper-slide");
        const swiper_fraction_current = survey_document_wrap.querySelector(".swiper_fraction_current");
        const swiper_fraction_length = survey_document_wrap.querySelector(".swiper_fraction_length");
        const survey_swiper_slide_length = survey_swiper_slide.length;
        const swiper_pagination_layer = document.querySelector(".swiper_pagination_layer");
        const btn_survey_close = document.querySelector(".btn_survey_close");
        const close_trigger = document.querySelectorAll(".survey_swiper_zone .close_trigger");
        if(!!survey_swiper_container){
        
            swiper_fraction_length.textContent = survey_swiper_slide_length-2;
            htmlElement.classList.add("touchDis");
            let survey_swiper = new Swiper(".swiper-container.survey",{
                on : {
                    init(){
                    console.log('init');
                    //controlFunc();
                    }
                },
                pagination: {
                    el: ".swiper_pagination_layer .swiper-pagination",
                },
                autoHeight : true
            });
            survey_swiper.on("slideChange",()=>{
                console.log('slideChange');
                controlFunc();
            });
            
            propsButton();
            if(!!close_trigger){
                close_trigger.forEach((item)=>{
                    item.addEventListener("click",()=>{
                        survey_document_wrap.style.display = "none";
                        htmlElement.classList.remove("touchDis");
                    });
                });
            }

            function controlFunc(){
                /* console.log(survey_swiper.realIndex); */
                if(survey_swiper.realIndex >= 1 && survey_swiper.realIndex < survey_swiper_slide_length - 1){
                    swiper_pagination_layer.classList.add("active");
                    swiper_fraction_current.textContent = survey_swiper.realIndex;
                }else{
                    swiper_pagination_layer.classList.remove("active");
                } 

                /* if(survey_swiper.realIndex == survey_swiper_slide_length - 1){
                    setTimeout(()=>{
                        survey_document_wrap.style.display = "none";
                        htmlElement.classList.remove("touchDis");
                    },1500);
                } */
            }

            function propsButton(){
                const props_button = document.querySelectorAll(".props_button");
                if(!!props_button){
                    props_button.forEach((item)=>{
                        item.addEventListener("click",(e)=>{
                            const thisEvent = e.currentTarget;
                            const thisEventParent = thisEvent.closest(".props_item_list");
                            const notEvent = thisEvent.closest(".survey_form_list").querySelectorAll(".props_button");
                            if(!!notEvent && !thisEventParent){
                                notEvent.forEach((item)=>{
                                    if(thisEvent !== item){
                                        item.classList.remove("active");
                                    }
                                });
                            }
                            thisEvent.classList.toggle("active");
                        });
                    });
                }
            }
        }
    }
</script>